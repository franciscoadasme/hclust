require "./spec_helper"

describe HClust::NNChain do
  describe "#linkage" do
    it_linkages "clusters using the single linkage",
      [
        {0, 17, 0.00000000},
        {17, 18, 0.00000000},
        {1, 18, 0.00014170},
        {2, 14, 0.00000425},
        {3, 14, 0.00018558},
        {4, 14, 0.00061327},
        {6, 7, 0.00000000},
        {7, 16, 0.00006115},
        {8, 9, 0.00001924},
        {9, 10, 0.00003325},
        {10, 16, 0.00028964},
        {5, 16, 0.00030650},
        {11, 13, 0.00000000},
        {12, 15, 0.00000343},
        {13, 15, 0.00023498},
        {14, 16, 0.00062791},
        {15, 16, 0.00196471},
        {18, 19, 0.00088411},
        {16, 19, 0.92729970},
      ],
      HClust::NNChain(HClust::Linkage::Single)

    it_linkages "clusters using the complete linkage",
      [
        {0, 17, 0.00000000},
        {17, 18, 0.00000000},
        {1, 18, 0.00014170},
        {2, 14, 0.00000425},
        {3, 14, 0.00024600},
        {6, 7, 0.00000000},
        {7, 16, 0.00006115},
        {4, 5, 0.00062791},
        {8, 9, 0.00001924},
        {9, 10, 0.00010306},
        {10, 16, 0.00122391},
        {5, 14, 0.00428575},
        {11, 13, 0.00000000},
        {12, 15, 0.00000343},
        {13, 15, 0.00029514},
        {15, 16, 0.00928559},
        {14, 16, 0.03188690},
        {18, 19, 0.00173310},
        {16, 19, 0.99731562},
      ],
      HClust::NNChain(HClust::Linkage::Complete)

    it_linkages "clusters using the weighted linkage",
      [
        {0, 17, 0.00000000},
        {17, 18, 0.00000000},
        {1, 18, 0.00014170},
        {2, 14, 0.00000425},
        {3, 14, 0.00021579},
        {6, 7, 0.00000000},
        {7, 16, 0.00006115},
        {8, 9, 0.00001924},
        {5, 16, 0.00047393},
        {4, 14, 0.00108376},
        {9, 10, 0.00006815},
        {10, 16, 0.00156916},
        {11, 13, 0.00000000},
        {12, 15, 0.00000343},
        {13, 15, 0.00026506},
        {14, 16, 0.00569826},
        {15, 16, 0.01383877},
        {18, 19, 0.00130861},
        {16, 19, 0.97807528},
      ],
      HClust::NNChain(HClust::Linkage::Weighted)

    it_linkages "clusters using the ward linkage",
      [
        {0, 17, 0.00000000},
        {17, 18, 0.00000000},
        {1, 18, 0.00021255},
        {2, 14, 0.00000425},
        {3, 14, 0.00028630},
        {6, 7, 0.00000000},
        {7, 16, 0.00008153},
        {4, 5, 0.00062791},
        {8, 9, 0.00001924},
        {9, 10, 0.00008446},
        {10, 16, 0.00179620},
        {5, 14, 0.00531057},
        {11, 13, 0.00000000},
        {12, 15, 0.00000343},
        {13, 15, 0.00052840},
        {15, 16, 0.02347690},
        {14, 16, 0.07120330},
        {18, 19, 0.00239086},
        {16, 19, 7.23521293},
      ],
      HClust::NNChain(HClust::Linkage::Ward)

    it_linkages "clusters using the average linkage",
      [
        {0, 17, 0.00000000},
        {17, 18, 0.00000000},
        {1, 18, 0.00014170},
        {2, 14, 0.00000425},
        {3, 14, 0.00021579},
        {6, 7, 0.00000000},
        {7, 16, 0.00006115},
        {8, 9, 0.00001924},
        {9, 10, 0.00006815},
        {5, 16, 0.00052974},
        {4, 14, 0.00124059},
        {10, 16, 0.00103290},
        {11, 13, 0.00000000},
        {12, 15, 0.00000343},
        {13, 15, 0.00026506},
        {15, 16, 0.00596833},
        {14, 16, 0.01338801},
        {18, 19, 0.00152085},
        {16, 19, 0.96840281},
      ],
      HClust::NNChain(HClust::Linkage::Average)
  end
end
